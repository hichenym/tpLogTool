# 控件禁用样式优化说明

## 问题描述

在深色主题下，控件的启用状态和禁用状态视觉区别不明显，用户难以分辨哪些控件是可用的，哪些是禁用的。

## 解决方案

为所有主要控件添加了明显的禁用状态样式，通过颜色和对比度的变化来区分启用和禁用状态。

## 样式对比

### 1. 输入框（QLineEdit, QTextEdit, QPlainTextEdit）

| 状态 | 背景色 | 文字色 | 边框色 |
|------|--------|--------|--------|
| **启用** | `#404040` (深灰) | `#e0e0e0` (浅灰) | `#555555` (中灰) |
| **禁用** | `#2b2b2b` (更深灰) | `#606060` (暗灰) | `#3c3c3c` (暗边框) |

**视觉效果：**
- 禁用时背景变暗，与页面背景接近
- 文字颜色明显变暗，不易阅读
- 边框颜色变暗，不显眼

### 2. 下拉框（QComboBox）

| 状态 | 背景色 | 文字色 | 边框色 | 下拉按钮 |
|------|--------|--------|--------|----------|
| **启用** | `#404040` | `#e0e0e0` | `#555555` | `#3c3c3c` |
| **禁用** | `#2b2b2b` | `#606060` | `#3c3c3c` | `#2b2b2b` |

**视觉效果：**
- 禁用时整体变暗
- 下拉按钮也变暗，提示不可点击
- 悬停效果消失

### 3. 日期选择器（QDateEdit）

| 状态 | 背景色 | 文字色 | 边框色 | 下拉按钮 |
|------|--------|--------|--------|----------|
| **启用** | `#404040` | `#e0e0e0` | `#555555` | `#3c3c3c` |
| **禁用** | `#2b2b2b` | `#606060` | `#3c3c3c` | `#2b2b2b` |

**视觉效果：**
- 与下拉框保持一致
- 日历图标按钮也变暗

### 4. 按钮（QPushButton）

| 状态 | 背景色 | 文字色 | 边框色 |
|------|--------|--------|--------|
| **启用** | `#3c3c3c` | `#e0e0e0` | `#555555` |
| **悬停** | `#4a4a4a` | `#e0e0e0` | `#0d7377` (青绿) |
| **按下** | `#0d7377` | `#e0e0e0` | `#0d7377` |
| **禁用** | `#2b2b2b` | `#707070` | `#3c3c3c` |

**视觉效果：**
- 禁用时背景变暗，与页面背景接近
- 文字颜色变为中灰色（`#707070`）
- 边框颜色变暗
- 无悬停和按下效果

### 5. 复选框（QCheckBox）

| 状态 | 文字色 | 框背景 | 框边框 | 选中背景 |
|------|--------|--------|--------|----------|
| **启用-未选** | `#e0e0e0` | `#404040` | `#555555` | - |
| **启用-已选** | `#e0e0e0` | `#0d7377` | `#0d7377` | `#0d7377` |
| **禁用-未选** | `#606060` | `#2b2b2b` | `#3c3c3c` | - |
| **禁用-已选** | `#606060` | `#1a4a4c` | `#3c3c3c` | `#1a4a4c` |

**视觉效果：**
- 禁用时文字变暗
- 复选框背景变暗
- 已选中的禁用状态使用暗青绿色（`#1a4a4c`）

## 颜色定义

### 主要颜色

```css
/* 背景色 */
#2b2b2b  /* 页面背景 / 禁用控件背景 */
#3c3c3c  /* 中灰背景 */
#404040  /* 启用控件背景 */
#4a4a4a  /* 悬停背景 */

/* 文字色 */
#e0e0e0  /* 启用文字 - 浅灰 */
#707070  /* 禁用按钮文字 - 中灰 */
#606060  /* 禁用输入框文字 - 暗灰 */

/* 边框色 */
#555555  /* 启用边框 - 中灰 */
#3c3c3c  /* 禁用边框 - 暗灰 */

/* 强调色 */
#0d7377  /* 青绿色 - 悬停/选中 */
#1a4a4c  /* 暗青绿色 - 禁用已选 */
```

### 对比度说明

| 对比 | 启用 | 禁用 | 差异 |
|------|------|------|------|
| 背景亮度 | 较亮 | 较暗 | 明显 |
| 文字亮度 | 亮 | 暗 | 明显 |
| 边框对比 | 清晰 | 模糊 | 明显 |

## 使用场景

### 1. 连接前后

**GitLab 日志页面：**
- 连接前：项目、分支、提交者、时间、导出按钮 - 全部禁用（暗灰色）
- 连接后：所有控件启用（正常颜色）

### 2. 查询前后

**设备状态页面：**
- 查询前：批量唤醒、全选、导出按钮 - 禁用
- 查询后：根据结果启用相应按钮

### 3. 操作进行中

**所有页面：**
- 操作进行中：相关按钮禁用，显示"查询中..."、"导出中..."等文字
- 操作完成：按钮恢复启用状态

## 视觉识别要点

### 快速识别禁用控件

1. **背景变暗** - 与页面背景接近，不突出
2. **文字变暗** - 不易阅读，提示不可用
3. **边框变淡** - 不明显，融入背景
4. **无交互反馈** - 悬停时无变化

### 快速识别启用控件

1. **背景较亮** - 从页面中突出
2. **文字清晰** - 易于阅读
3. **边框清晰** - 明显的轮廓
4. **有交互反馈** - 悬停时边框变青绿色

## 用户体验改进

### 改进前

- ❌ 禁用和启用状态难以区分
- ❌ 用户可能尝试点击禁用的控件
- ❌ 不清楚哪些操作可以执行
- ❌ 整体界面缺乏层次感

### 改进后

- ✅ 禁用和启用状态一目了然
- ✅ 用户可以快速识别可用控件
- ✅ 清楚知道当前可以执行的操作
- ✅ 界面层次分明，视觉引导明确

## 技术实现

### CSS 伪类选择器

```css
/* 启用状态（默认） */
QLineEdit {
    background-color: #404040;
    color: #e0e0e0;
}

/* 禁用状态 */
QLineEdit:disabled {
    background-color: #2b2b2b;
    color: #606060;
}
```

### 代码中的使用

```python
# 禁用控件
self.project_combo.setEnabled(False)

# 启用控件
self.project_combo.setEnabled(True)
```

## 注意事项

### 1. 只读 vs 禁用

- **只读**（`setReadOnly(True)`）：可以选中和复制文本，但不能编辑
- **禁用**（`setEnabled(False)`）：完全不可交互

**样式区别：**
- 只读：保持启用样式（可读性好）
- 禁用：使用禁用样式（明显不可用）

### 2. 占位文字

禁用状态下，占位文字（placeholder）也会变暗，保持一致性。

### 3. 图标

按钮上的图标在禁用状态下也会自动变暗（Qt 自动处理）。

## 测试建议

### 测试场景

1. **初始状态** - 检查默认禁用的控件是否明显
2. **状态切换** - 检查启用/禁用切换是否流畅
3. **批量操作** - 检查多个控件同时禁用的效果
4. **不同页面** - 检查所有页面的一致性

### 测试要点

- [ ] 禁用控件是否明显变暗
- [ ] 文字是否清晰可辨但明显不可用
- [ ] 边框是否变淡
- [ ] 悬停时是否无反馈
- [ ] 点击时是否无响应
- [ ] 启用后是否恢复正常

## 总结

通过优化禁用状态的样式，显著提升了用户界面的可用性和用户体验：

1. **视觉层次清晰** - 启用和禁用状态一目了然
2. **操作引导明确** - 用户知道可以做什么
3. **减少误操作** - 不会尝试点击禁用的控件
4. **专业美观** - 整体界面更加精致

这些改进使得应用程序更加易用和专业。
