# è‡ªåŠ¨æ›´æ–°åŠŸèƒ½æ€»ç»“

## åŠŸèƒ½æ¦‚è§ˆ

TPQueryTool æ”¯æŒå®Œæ•´çš„è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬æ£€æŸ¥ã€ä¸‹è½½ã€å®‰è£…å’Œé‡å¯ã€‚

## æ›´æ–°æµç¨‹

### ç”¨æˆ·è§†è§’

```
ç¨‹åºå¯åŠ¨
  â†“
åå°æ£€æŸ¥æ›´æ–°ï¼ˆ2ç§’åï¼‰
  â†“
å¦‚æœæœ‰æ–°ç‰ˆæœ¬
  â†“
å¼¹å‡ºæ›´æ–°æç¤ºå¯¹è¯æ¡†
  â”œâ”€ ç«‹å³æ›´æ–° â†’ åå°ä¸‹è½½ï¼ˆçŠ¶æ€æ æ˜¾ç¤ºè¿›åº¦ï¼‰â†’ å®Œæˆåå¼¹å‡ºé‡å¯å¯¹è¯æ¡†
  â”œâ”€ ç¨åæé†’ â†’ ä¸‹æ¬¡å¯åŠ¨å†æç¤º
  â””â”€ è·³è¿‡æ­¤ç‰ˆæœ¬ â†’ è®°å½•è·³è¿‡ï¼Œä¸å†æç¤ºæ­¤ç‰ˆæœ¬
```

### ä¸‹è½½ä½“éªŒ

ç‚¹å‡»"ç«‹å³æ›´æ–°"åï¼š
1. å¯¹è¯æ¡†å…³é—­ï¼Œå›åˆ°ä¸»ç•Œé¢
2. çŠ¶æ€æ æ˜¾ç¤ºï¼š`æ­£åœ¨ä¸‹è½½æ›´æ–° V3.1.0...`
3. å®æ—¶æ›´æ–°è¿›åº¦ï¼š`æ­£åœ¨ä¸‹è½½æ›´æ–°: 45.2 MB / 173.1 MB (26%)`
4. ä¸‹è½½å®Œæˆï¼š`âœ“ æ›´æ–°ä¸‹è½½å®Œæˆ`
5. å¼¹å‡ºé‡å¯å¯¹è¯æ¡†

**ä¼˜åŠ¿**ï¼š
- ä¸é˜»å¡ä¸»ç•Œé¢
- å¯ä»¥ç»§ç»­ä½¿ç”¨ç¨‹åº
- è¿›åº¦ä¿¡æ¯æ¸…æ™°
- ä½“éªŒæµç•…

## ä¸‰ç§æ›´æ–°ç­–ç•¥

### 1. promptï¼ˆæç¤ºæ›´æ–°ï¼‰- é»˜è®¤

- å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°
- å‘ç°æ–°ç‰ˆæœ¬æ—¶å¼¹å‡ºæç¤º
- ç”¨æˆ·å†³å®šæ˜¯å¦æ›´æ–°
- é€‚åˆå¤§å¤šæ•°ç”¨æˆ·

### 2. silentï¼ˆé™é»˜æ›´æ–°ï¼‰

- å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°
- å‘ç°æ–°ç‰ˆæœ¬æ—¶åå°ä¸‹è½½
- ä¸‹è½½å®Œæˆåæç¤º
- å…³é—­ç¨‹åºæ—¶è‡ªåŠ¨å®‰è£…
- é€‚åˆä¼ä¸šç¯å¢ƒ

### 3. manualï¼ˆæ‰‹åŠ¨æ›´æ–°ï¼‰

- ä¸è‡ªåŠ¨æ£€æŸ¥æ›´æ–°
- ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»"æ£€æŸ¥æ›´æ–°"
- é€‚åˆç¦»çº¿ç¯å¢ƒæˆ–ç‰¹æ®Šéœ€æ±‚

## è·³è¿‡ç‰ˆæœ¬åŠŸèƒ½

### ä½¿ç”¨åœºæ™¯

- æŸä¸ªç‰ˆæœ¬æœ‰å·²çŸ¥é—®é¢˜ï¼Œæš‚æ—¶ä¸æƒ³å‡çº§
- ç­‰å¾…æ›´ç¨³å®šçš„ç‰ˆæœ¬
- å½“å‰ç‰ˆæœ¬æ»¡è¶³éœ€æ±‚

### ä½¿ç”¨æ–¹æ³•

1. æ›´æ–°æç¤ºå¯¹è¯æ¡†ä¸­ç‚¹å‡»"è·³è¿‡æ­¤ç‰ˆæœ¬"
2. ç³»ç»Ÿå°†ç‰ˆæœ¬å·ä¿å­˜åˆ° Windows æ³¨å†Œè¡¨
3. ä¸‹æ¬¡å¯åŠ¨ä¸å†æç¤ºè¯¥ç‰ˆæœ¬
4. å¦‚æœæœ‰æ›´æ–°çš„ç‰ˆæœ¬ï¼Œä»ä¼šæ­£å¸¸æç¤º

### å­˜å‚¨ä½ç½®

**æ³¨å†Œè¡¨è·¯å¾„**ï¼š
```
HKEY_CURRENT_USER\Software\TPQueryTool\Update
é”®å: SkippedVersion
ç±»å‹: REG_SZ (å­—ç¬¦ä¸²)
å€¼: ç‰ˆæœ¬å·ï¼ˆå¦‚ "3.1.0"ï¼‰
```

### ç®¡ç†è·³è¿‡è®°å½•

**æŸ¥çœ‹è·³è¿‡çš„ç‰ˆæœ¬**ï¼š
1. æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼ˆWin+Rï¼Œè¾“å…¥ regeditï¼‰
2. å¯¼èˆªåˆ° `HKEY_CURRENT_USER\Software\TPQueryTool\Update`
3. æŸ¥çœ‹ `SkippedVersion` é”®å€¼

**æ¸…é™¤è·³è¿‡è®°å½•**ï¼š
1. åœ¨æ³¨å†Œè¡¨ç¼–è¾‘å™¨ä¸­åˆ é™¤ `SkippedVersion` é”®å€¼
2. æˆ–ä½¿ç”¨ç¨‹åºæä¾›çš„æ¸…é™¤åŠŸèƒ½ï¼ˆå¦‚æœå®ç°ï¼‰

**ç‰¹ç‚¹**ï¼š
- åªä¿å­˜æœ€æ–°è·³è¿‡çš„ç‰ˆæœ¬ï¼ˆæ–°è·³è¿‡ä¼šè¦†ç›–æ—§è®°å½•ï¼‰
- ç”¨æˆ·å¯ä»¥ç›´æ¥ä¿®æ”¹æ³¨å†Œè¡¨æ¥ç®¡ç†
- ç¬¦åˆ Windows åº”ç”¨ç¨‹åºçš„æ ‡å‡†åšæ³•

## é…ç½®æ–‡ä»¶

### version.json æ ¼å¼

```json
{
  "version": "3.1.0",
  "build_date": "20260224",
  "download_url": "https://github.com/hichenym/tpLogTool/releases/download/v3.1.0/TPQueryTool.exe",
  "file_size_mb": 173.06,
  "release_notes_url": "https://github.com/hichenym/tpLogTool/releases/tag/v3.1.0",
  "min_version": "3.0.0",
  "update_strategy": "prompt",
  "changelog": [
    "ğŸš€ æ–°åŠŸèƒ½1",
    "ğŸ› ä¿®å¤é—®é¢˜2",
    "âœ¨ æ”¹è¿›3"
  ]
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| version | string | ç‰ˆæœ¬å·ï¼ˆå¦‚ "3.1.0"ï¼‰ |
| build_date | string | ç¼–è¯‘æ—¥æœŸï¼ˆå¦‚ "20260224"ï¼‰ |
| download_url | string | ä¸‹è½½åœ°å€ï¼ˆGitHub Releaseï¼‰ |
| file_size_mb | number | æ–‡ä»¶å¤§å°ï¼ˆMBï¼‰ |
| release_notes_url | string | å‘å¸ƒè¯´æ˜é“¾æ¥ |
| min_version | string | æœ€ä½å…¼å®¹ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰ |
| update_strategy | string | æ›´æ–°ç­–ç•¥ï¼ˆprompt/silent/manualï¼‰ |
| changelog | array | æ›´æ–°æ—¥å¿—åˆ—è¡¨ |

## ä¸‹è½½ä¼˜åŒ–

### é‡è¯•æœºåˆ¶

- æœ€å¤šé‡è¯• 3 æ¬¡
- æ¯æ¬¡é‡è¯•é—´éš” 2 ç§’
- è‡ªåŠ¨åˆ‡æ¢ä¸‹è½½æºï¼ˆå¦‚æœé…ç½®äº†é•œåƒï¼‰

### è¶…æ—¶é…ç½®

- è¿æ¥è¶…æ—¶ï¼š10 ç§’
- è¯»å–è¶…æ—¶ï¼š300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰

### ä¸´æ—¶æ–‡ä»¶æœºåˆ¶

- ä¸‹è½½åˆ° `.tmp` æ–‡ä»¶
- å®Œæˆåé‡å‘½åä¸ºæ­£å¼æ–‡ä»¶
- é¿å…ä¸‹è½½ä¸­æ–­å¯¼è‡´æ–‡ä»¶æŸå

### é”™è¯¯å¤„ç†

è¯¦ç»†çš„é”™è¯¯åˆ†ç±»å’Œæç¤ºï¼š
- ç½‘ç»œè¿æ¥å¤±è´¥
- ä¸‹è½½è¶…æ—¶
- æ–‡ä»¶æ ¡éªŒå¤±è´¥
- ç£ç›˜ç©ºé—´ä¸è¶³

## å®‰è£…å’Œé‡å¯

### å®‰è£…æµç¨‹

1. ä¸‹è½½å®Œæˆåï¼Œæ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶ç›®å½•
2. ç”¨æˆ·é€‰æ‹©"ç«‹å³é‡å¯"
3. ç¨‹åºåˆ›å»ºæ‰¹å¤„ç†è„šæœ¬
4. æ‰¹å¤„ç†è„šæœ¬ç­‰å¾…ç¨‹åºé€€å‡º
5. æ›¿æ¢æ—§æ–‡ä»¶
6. å¯åŠ¨æ–°ç‰ˆæœ¬
7. æ¸…ç†ä¸´æ—¶æ–‡ä»¶

### æ‰¹å¤„ç†è„šæœ¬ç¤ºä¾‹

```batch
@echo off
timeout /t 2 /nobreak > nul
move /y "ä¸´æ—¶æ–‡ä»¶.exe" "TPQueryTool.exe"
start "" "TPQueryTool.exe"
del "%~f0"
```

## æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°

### åœ¨è®¾ç½®ä¸­æ£€æŸ¥

1. ç‚¹å‡»å³ä¸Šè§’è®¾ç½®æŒ‰é’®
2. åˆ‡æ¢åˆ°"å…³äº"æ ‡ç­¾é¡µ
3. ç‚¹å‡»"æ£€æŸ¥æ›´æ–°"æŒ‰é’®
4. ç­‰å¾…æ£€æŸ¥ç»“æœ

### æ£€æŸ¥ç»“æœ

- **æœ‰æ–°ç‰ˆæœ¬**ï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œå¼¹å‡ºæ›´æ–°æç¤ºå¯¹è¯æ¡†
- **å·²æ˜¯æœ€æ–°ç‰ˆæœ¬**ï¼šæ˜¾ç¤ºæç¤ºæ¶ˆæ¯
- **æ£€æŸ¥å¤±è´¥**ï¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

## ç¼“å­˜æœºåˆ¶

### ç‰ˆæœ¬ä¿¡æ¯ç¼“å­˜

- ç¼“å­˜æ–‡ä»¶ï¼š`~/.TPQueryTool/update/version_cache.json`
- ç¼“å­˜æœ‰æ•ˆæœŸï¼š24 å°æ—¶
- ç½‘ç»œå¤±è´¥æ—¶ä½¿ç”¨ç¼“å­˜

### è·³è¿‡ç‰ˆæœ¬è®°å½•

- å­˜å‚¨ä½ç½®ï¼šWindows æ³¨å†Œè¡¨ `HKEY_CURRENT_USER\Software\TPQueryTool\Update\SkippedVersion`
- æŒä¹…åŒ–å­˜å‚¨
- åªä¿å­˜æœ€æ–°è·³è¿‡çš„ç‰ˆæœ¬
- ç”¨æˆ·å¯é€šè¿‡æ³¨å†Œè¡¨ç¼–è¾‘å™¨ç®¡ç†

## ç½‘ç»œé…ç½®

### ç‰ˆæœ¬ä¿¡æ¯ URL

**ä¸» URLï¼ˆCDNï¼Œä¼˜å…ˆï¼‰**ï¼š
```
https://cdn.jsdelivr.net/gh/hichenym/tpLogTool@main/version.json
```

**å¤‡ç”¨ URLï¼ˆGitHub Rawï¼‰**ï¼š
```
https://raw.githubusercontent.com/hichenym/tpLogTool/main/version.json
```

### ä¸‹è½½ URL

ä» `version.json` ä¸­çš„ `download_url` å­—æ®µè·å–ï¼š
```
https://github.com/hichenym/tpLogTool/releases/download/v3.1.0/TPQueryTool.exe
```

## æ—¥å¿—è®°å½•

### æ—¥å¿—ä½ç½®

```
C:\Users\<ç”¨æˆ·å>\.TPQueryTool\logs\tpquerytool_YYYYMMDD.log
```

### å…³é”®æ—¥å¿—

```
INFO - ç¨‹åºå¯åŠ¨: TPQueryTool V3.0.0
INFO - å¼€å§‹æ£€æŸ¥æ›´æ–°...
INFO - å‘ç°æ–°ç‰ˆæœ¬: V3.1.0 (20260224)
INFO - ç”¨æˆ·é€‰æ‹©ç«‹å³æ›´æ–°
INFO - å¼€å§‹ä¸‹è½½æ›´æ–°: 3.1.0
INFO - ä¸‹è½½å®Œæˆ: C:\Users\...\TPQueryTool_3.1.0.exe
INFO - ç”¨æˆ·é€‰æ‹©ç«‹å³é‡å¯ï¼Œåº”ç”¨æ›´æ–°...
```

## æ•…éšœæ’æŸ¥

### æ£€æŸ¥æ›´æ–°å¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- ç½‘ç»œè¿æ¥é—®é¢˜
- GitHub è®¿é—®å—é™
- é˜²ç«å¢™é˜»æ­¢

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. å°è¯•è®¿é—® GitHub
3. é…ç½®ä»£ç†ï¼ˆå¦‚æœéœ€è¦ï¼‰
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶

### ä¸‹è½½å¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- ç½‘ç»œä¸ç¨³å®š
- ä¸‹è½½è¶…æ—¶
- ç£ç›˜ç©ºé—´ä¸è¶³

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥ç£ç›˜ç©ºé—´
3. é‡è¯•ä¸‹è½½
4. æ‰‹åŠ¨ä¸‹è½½å®‰è£…

### å®‰è£…å¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- æ–‡ä»¶è¢«å ç”¨
- æƒé™ä¸è¶³
- æ€æ¯’è½¯ä»¶é˜»æ­¢

**è§£å†³æ–¹æ³•**ï¼š
1. å…³é—­ç¨‹åº
2. ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
3. ä¸´æ—¶å…³é—­æ€æ¯’è½¯ä»¶
4. æ‰‹åŠ¨æ›¿æ¢æ–‡ä»¶

## ç›¸å…³æ–‡æ¡£

- [è‡ªåŠ¨æ›´æ–°å®ç°æ–¹æ¡ˆ](auto-update-implementation.md)
- [é™é»˜æ›´æ–°æŒ‡å—](silent-update-guide.md)
- [æ›´æ–°ç­–ç•¥æŒ‡å—](update-strategy-guide.md)
- [ç½‘ç»œé—®é¢˜æ’æŸ¥](update-network-troubleshooting.md)
- [UI æ”¹è¿›è¯´æ˜](update-ui-improvements.md)
- [å¿«é€Ÿå‚è€ƒ](update-quick-reference.md)

## å¼€å‘è€…å‚è€ƒ

### æ ¸å¿ƒæ¨¡å—

1. `query_tool/utils/update_checker.py` - ç‰ˆæœ¬æ£€æŸ¥
2. `query_tool/utils/update_downloader.py` - ä¸‹è½½ç®¡ç†
3. `query_tool/utils/update_manager.py` - æ›´æ–°ç®¡ç†å™¨
4. `query_tool/widgets/update_dialog.py` - æ›´æ–°å¯¹è¯æ¡†

### å…³é”®ç±»

- `UpdateChecker` - ç‰ˆæœ¬æ£€æŸ¥å™¨
- `UpdateDownloader` - ä¸‹è½½å™¨
- `UpdateManager` - æ›´æ–°ç®¡ç†å™¨
- `UpdateInstaller` - å®‰è£…å™¨
- `VersionInfo` - ç‰ˆæœ¬ä¿¡æ¯

### ä¿¡å·å’Œæ§½

```python
# UpdateManager ä¿¡å·
update_available = pyqtSignal(object)  # å‘ç°æ–°ç‰ˆæœ¬
download_progress = pyqtSignal(int, int)  # ä¸‹è½½è¿›åº¦
download_finished = pyqtSignal(bool, str)  # ä¸‹è½½å®Œæˆ

# ä¸»çª—å£æ§½å‡½æ•°
on_update_available(version_info)  # å¤„ç†æ–°ç‰ˆæœ¬
on_download_progress(downloaded, total)  # æ›´æ–°è¿›åº¦
on_download_finished(success, result)  # å¤„ç†å®Œæˆ
```

## æµ‹è¯•

### æµ‹è¯•è„šæœ¬

```bash
# æµ‹è¯•æ›´æ–°æ£€æŸ¥
python test_update.py

# æµ‹è¯•ä¸‹è½½é‡è¯•
python test_download_retry.py

# æµ‹è¯•è·³è¿‡ç‰ˆæœ¬
python test_skip_version.py

# æµ‹è¯•è®¾ç½®é¡µé¢æ›´æ–°
python test_settings_update.py
```

### æ‰‹åŠ¨æµ‹è¯•

1. ä¿®æ”¹ `version.json` ä¸­çš„ç‰ˆæœ¬å·
2. å¯åŠ¨ç¨‹åº
3. è§‚å¯Ÿæ›´æ–°æç¤º
4. æµ‹è¯•å„ç§æ“ä½œ
5. æŸ¥çœ‹æ—¥å¿—

## ç‰ˆæœ¬å†å²

### V3.1.0 (2026-02-24)
- âœ… å®ç°å®Œæ•´çš„è‡ªåŠ¨æ›´æ–°åŠŸèƒ½
- âœ… æ”¯æŒä¸‰ç§æ›´æ–°ç­–ç•¥
- âœ… æ·»åŠ ä¸‹è½½é‡è¯•æœºåˆ¶
- âœ… ä¼˜åŒ–ä¸‹è½½è¶…æ—¶é…ç½®
- âœ… å®ç°è·³è¿‡ç‰ˆæœ¬åŠŸèƒ½
- âœ… ä¼˜åŒ–ä¸‹è½½è¿›åº¦æ˜¾ç¤ºï¼ˆçŠ¶æ€æ ï¼‰

### V3.0.0 (2026-02-20)
- åˆå§‹ç‰ˆæœ¬
- åŸºç¡€åŠŸèƒ½å®ç°
