# GitLab 日志导出功能 - 快速开始指南

## 5分钟快速上手

### 第一步：获取 GitLab Token

1. 登录你的 GitLab 账号
2. 点击右上角头像 → **Settings**（设置）
3. 左侧菜单选择 **Access Tokens**（访问令牌）
4. 填写 Token 信息：
   - **Token name**：随便起个名字，如 "日志导出工具"
   - **Expiration date**：过期时间（建议设置较长时间）
   - **Select scopes**：勾选 **api**（必须）
5. 点击 **Create personal access token** 按钮
6. **重要**：复制生成的 Token（只显示一次，请妥善保存）

### 第二步：启动程序

1. 双击运行 `设备查询工具.exe`
2. 点击菜单栏的 **Git日志** 按钮

### 第三步：连接 GitLab 服务器

1. 在"服务器连接"区域填写：
   - **服务器**：你的 GitLab 地址（如 `https://gitlab.example.com`）
   - **Token**：刚才复制的 Token
2. 点击 **连接** 按钮
3. 等待连接成功（状态栏会显示"连接成功! 获取到 XX 个项目"）

### 第四步：选择项目和分支

1. 在"查询条件"区域：
   - **项目**：从下拉框选择或搜索项目
   - **分支**：选择要查询的分支（默认分支会标记）
   - **提交者**：可选，筛选特定提交者
   - **关键词**：可选，多个关键词用分号分隔

### 第五步：设置时间范围

1. 在"时间范围与导出"区域：
   - **开始时间**：默认最近30天
   - **结束时间**：默认今天
   - 可以点击日历图标选择日期

### 第六步：导出日志

1. 点击 **浏览** 按钮选择保存目录
2. 点击 **导出** 按钮
3. 等待导出完成（状态栏会显示进度）
4. 导出成功后会提示文件名和记录数

### 第七步：查看结果

1. 打开保存目录
2. 找到导出的 Excel 文件（文件名格式：`gitlog_项目_分支_日期.xlsx`）
3. 用 Excel 或 WPS 打开文件
4. 文件包含5列：
   - **提交ID**：点击可跳转到 GitLab
   - **提交消息**：提交说明
   - **提交者**：提交人姓名
   - **提交时间**：提交日期时间
   - **文件变化**：修改的文件列表

## 常见问题

### Q1: 连接失败怎么办？

**可能原因：**
- 服务器地址错误（检查是否包含 `https://`）
- Token 错误或已过期（重新生成 Token）
- 网络连接问题（检查网络）
- Token 权限不足（确保勾选了 `api` 权限）

**解决方法：**
1. 检查服务器地址格式
2. 重新生成 Token 并确保勾选 `api` 权限
3. 检查网络连接
4. 查看状态栏的错误提示

### Q2: 找不到项目怎么办？

**可能原因：**
- 项目名称记错了
- 没有项目访问权限
- 项目在其他 Group 下

**解决方法：**
1. 使用搜索功能（下拉框可以输入）
2. 检查 GitLab 上是否有该项目的访问权限
3. 查看项目完整路径（group/project）

### Q3: 导出的文件在哪里？

**查找方法：**
1. 查看"保存路径"输入框显示的目录
2. 状态栏会显示导出成功的文件名
3. 文件名格式：`gitlog_项目_分支_开始日期_to_结束日期.xlsx`

### Q4: 为什么没有提交记录？

**可能原因：**
- 时间范围内确实没有提交
- 选择的分支没有提交
- 提交者筛选过滤掉了所有记录

**解决方法：**
1. 扩大时间范围
2. 切换到其他分支
3. 取消提交者筛选（选择"全部提交者"）

### Q5: 关键词高亮怎么用？

**使用方法：**
1. 在"关键词"输入框输入关键词
2. 多个关键词用分号（`;`）分隔
3. 例如：`修复;优化;新增`
4. 导出后，包含这些关键词的行会有蓝色背景

**注意事项：**
- 关键词不区分大小写
- 只要提交消息包含关键词就会高亮
- 关键词可以是中文或英文

### Q6: 如何查看文件变化？

**查看方法：**
1. 打开导出的 Excel 文件
2. 查看最后一列"文件变化"
3. 每个文件一行，格式：
   - `[新增] 文件路径`
   - `[删除] 文件路径`
   - `[修改] 文件路径`
   - `[重命名] 旧路径 -> 新路径`

### Q7: 提交ID的超链接怎么用？

**使用方法：**
1. 打开导出的 Excel 文件
2. 点击第一列的提交ID（蓝色下划线）
3. 会自动在浏览器中打开 GitLab 的提交详情页
4. 可以查看完整的代码变化

### Q8: 配置会保存吗？

**自动保存：**
- ✅ 服务器地址
- ✅ Token（加密存储）
- ✅ 保存路径
- ✅ 最近使用的项目（最多6个）
- ✅ 最近使用的分支（每个项目最多6个）

**下次启动：**
- 自动加载上次的配置
- 最近使用的项目和分支会优先显示（带★标记）

### Q9: 如何断开连接？

**断开方法：**
1. 点击 **断开** 按钮（连接成功后按钮文字会变成"断开"）
2. 会清空项目和分支列表
3. 可以重新输入服务器地址和 Token

### Q10: 导出很慢怎么办？

**优化方法：**
1. 缩小时间范围（如只查询最近7天）
2. 选择提交较少的分支
3. 使用提交者筛选
4. 检查网络速度

**正常速度参考：**
- 100条记录：约10-30秒
- 500条记录：约1-2分钟
- 1000条记录：约3-5分钟

## 高级技巧

### 技巧1：快速切换项目

最近使用的项目会显示在下拉框顶部，带★标记，可以快速选择。

### 技巧2：搜索项目

下拉框可以直接输入文字搜索，支持模糊匹配。

### 技巧3：批量导出

如果需要导出多个项目或分支：
1. 导出第一个
2. 切换项目/分支
3. 再次导出
4. 文件会自动添加序号，不会覆盖

### 技巧4：定期导出

建议每周或每月定期导出一次，作为项目记录：
1. 设置固定的时间范围（如上周、上月）
2. 导出到固定目录
3. 文件名会自动包含日期，便于归档

### 技巧5：团队统计

使用提交者筛选功能，可以统计每个成员的提交情况：
1. 选择提交者
2. 设置时间范围
3. 导出后查看记录数

## 注意事项

### 安全提示
- ⚠️ Token 相当于密码，请妥善保管
- ⚠️ 不要将 Token 分享给他人
- ⚠️ Token 过期后需要重新生成
- ⚠️ 建议定期更换 Token

### 使用建议
- 💡 首次使用建议先测试小范围导出
- 💡 大量数据导出建议在网络良好时进行
- 💡 定期备份导出的文件
- 💡 关键词高亮可以快速定位重要提交

### 性能建议
- 📊 单次导出建议不超过1000条记录
- 📊 时间范围建议不超过3个月
- 📊 大型项目建议按分支分别导出
- 📊 网络不稳定时建议缩小范围

## 快速参考

### 快捷操作

| 操作 | 说明 |
|------|------|
| 连接服务器 | 填写地址和Token，点击"连接" |
| 搜索项目 | 在项目下拉框直接输入 |
| 选择日期 | 点击日历图标 |
| 导出日志 | 选择保存路径，点击"导出" |
| 断开连接 | 点击"断开"按钮 |

### 文件格式

| 列名 | 说明 | 示例 |
|------|------|------|
| 提交ID | 短ID，带超链接 | a1b2c3d |
| 提交消息 | 提交说明 | 修复登录bug |
| 提交者 | 提交人姓名 | 张三 |
| 提交时间 | 日期时间 | 2026-01-22 10:30:00 |
| 文件变化 | 修改的文件 | [修改] src/main.py |

### 配置路径

| 配置项 | 存储位置 |
|--------|---------|
| 服务器地址 | 注册表 |
| Token | 注册表（加密） |
| 保存路径 | 注册表 |
| 最近项目 | 注册表（JSON） |
| 最近分支 | 注册表（JSON） |

**注册表路径：** `HKEY_CURRENT_USER\Software\TPQueryTool\GitLab`

## 获取帮助

如果遇到问题：
1. 查看状态栏的错误提示
2. 查看本文档的"常见问题"部分
3. 查看详细文档：`md/GitLab日志功能移植说明.md`
4. 联系开发团队

## 总结

GitLab 日志导出功能简单易用，只需7步即可完成：

1. ✅ 获取 Token
2. ✅ 启动程序
3. ✅ 连接服务器
4. ✅ 选择项目和分支
5. ✅ 设置时间范围
6. ✅ 导出日志
7. ✅ 查看结果

祝使用愉快！ 🎉
